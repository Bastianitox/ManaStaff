{% extends 'staffweb/plantilla.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'staffweb/css/perfil.css' %}">
<link rel="stylesheet" href="{% static 'staffweb/css/cambiar_contrasena.css' %}">
<script src="{% static 'staffweb/js/cambiar_contrasena.js' %}"></script>
<script src="{% static 'staffweb/js/ojos_contra.js' %}"></script>
<title>Cambiar ContraseÃ±a</title>
{% endblock head%}

{% block principal %}
<div class="header">
  <h1>Cambiar ContraseÃ±a</h1>
  <p>Actualiza tu contraseÃ±a para mantener tu cuenta segura</p>
</div>

<div class="perfil-formulario">
    <form method="post" id="form-cambiar-contrasena">
      {% csrf_token %}
      
      <div class="campo">
        <label for="password_actual">ContraseÃ±a Actual</label>
        <div class="input-grupo">
          <input type="password" id="password_actual" name="password_actual" placeholder="Ingresa tu contraseÃ±a actual" required>
          <button type="button" class="toggle-password" data-target="password_actual" aria-label="Mostrar contraseÃ±a">
            <span class="icono-ojo">ğŸ‘</span>
            <span class="icono-ojo-cerrado oculto">ğŸ‘â€ğŸ—¨</span>
          </button>
        </div>
      </div>

      <div class="campo">
        <label for="nueva_password">Nueva ContraseÃ±a</label>
        <div class="input-grupo">
          <input type="password" id="nueva_password" name="nueva_password" placeholder="Ingresa una nueva contraseÃ±a" required>
          <button type="button" class="toggle-password" data-target="nueva_password" aria-label="Mostrar contraseÃ±a">
            <span class="icono-ojo">ğŸ‘</span>
            <span class="icono-ojo-cerrado oculto">ğŸ‘â€ğŸ—¨</span>
          </button>
        </div>
      </div>

      <div class="campo">
        <label for="confirmar_password">Confirmar Nueva ContraseÃ±a</label>
        <div class="input-grupo">
          <input type="password" id="confirmar_password" name="confirmar_password" placeholder="Repite la nueva contraseÃ±a" required>
          <button type="button" class="toggle-password" data-target="confirmar_password" aria-label="Mostrar contraseÃ±a">
            <span class="icono-ojo">ğŸ‘</span>
            <span class="icono-ojo-cerrado oculto">ğŸ‘â€ğŸ—¨</span>
          </button>
        </div>

        <!-- Recuadro de validaciones -->
        <div class="password-requirements">
          <p class="requirements-title">La contraseÃ±a debe contener:</p>
          <div class="requirements-list">
            <div class="requirement-item" id="req-length">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Entre 8 y 30 caracteres</span>
            </div>
            <div class="requirement-item" id="req-uppercase">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Al menos una letra mayÃºscula</span>
            </div>
            <div class="requirement-item" id="req-lowercase">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Al menos una letra minÃºscula</span>
            </div>
            <div class="requirement-item" id="req-number">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Al menos un nÃºmero</span>
            </div>
            <div class="requirement-item" id="req-special">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Al menos un carÃ¡cter especial</span>
            </div>
            <div class="requirement-item" id="req-match">
              <span class="requirement-icon">âœ“</span>
              <span class="requirement-text">Las contraseÃ±as coinciden</span>
            </div>
          </div>
        </div>
      </div>

      <div class="acciones-seguridad" >
        <button id="submitBtn" type="submit" class="btn-guardar">Guardar Cambios</button>
        <a href="{% url 'inicio_perfil' %}" class="btn-cancelar">Cancelar</a>
      </div>
    </form>
  </div>
</div>

<!-- ALERTAS CENTRADAS -->
<div id="successAlert" class="alert success" style="display:none;">
  <div class="alert-icon">âœ“</div>
  <span id="successMessageAlert">ContraseÃ±a modificada exitosamente.</span>
</div>

<div id="errorAlert" class="alert error" style="display:none;">
  <div class="alert-icon">âœ•</div>
  <span id="errorMessageAlert">OcurriÃ³ un error al modificar la contraseÃ±a.</span>
</div>

<!-- Overlay de carga -->
<div id="loadingOverlay">
    <div class="spinner"></div>
</div>

{% endblock principal %}

{% block js %}

<script>
    const currentUserRut = "{{ usuario_id|escapejs }}";
</script>
<script src="{% static 'staffweb/js/cambiar_contrasena.js' %}"></script>
{% endblock js %}