{% extends 'staffweb/plantilla.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'staffweb/css/administrar_documentos.css' %}">
<title>Administrar documentos</title>
{% endblock head %}

{% block principal %}
<div class="header">
  <h1>Administrar Documentos</h1>
  <p>Gestiona los documentos de los usuarios</p>
</div>

<div class="search-filter-section">
  <div class="search-container">
    <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none"
         viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
    </svg>
    <input type="text" class="search-input" placeholder="Busca por nombre de usuario..." id="searchInput">
  </div>
</div>

<div class="status-tabs">
    <button class="status-tab" data-status="todos">Todos</button>
    <button class="status-tab" data-status="activo">Activos</button>
    <button class="status-tab" data-status="pendiente">Pendientes</button>
    <button class="status-tab" data-status="caducado">Caducados</button>
</div>

<div class="documents-section">
  <div class="section-header">
    <h2>Documentos por Usuario</h2>
    <a href="{% url 'crear_documento' %}" class="btn-create-document" style="text-decoration: none;">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
        stroke="currentColor" width="20" height="20">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M12 4v16m8-8H4"/>
        </svg>
        Crear Documento
    </a>
  </div>
  <div id="usersContainer"></div>
</div>

<script id="users-docs-data" type="application/json">
  {{ users_docs_json|default:"[]"|safe }}
</script>


<script>
  window.ROUTES = {
    documentosUsuarios: "{% url 'documentos_usuarios' %}",
    crearDocumento: "{% url 'crear_documento' %}"
  };
</script>

<script>
  window.ROUTES.eliminarDocumento = "{% url 'eliminar_documento' %}";
</script>

<script>

  const goDocsUsuario = (rut) => {
    const limpio = String(rut).replace(/[^\dkK]/g, "");
    window.location.href = `${window.ROUTES.documentosUsuarios}?rut=${encodeURIComponent(limpio)}`;
  };
</script>
{% endblock principal %}

{% block js %}
  <script src="{% static 'staffweb/js/administrar_documentos.js' %}"></script>
{% endblock js %}